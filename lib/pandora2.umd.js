(function(e,k){typeof exports=="object"&&typeof module<"u"?k(exports,require("vue"),require("element-plus"),require("lodash-es"),require("@element-plus/icons-vue"),require("dayjs")):typeof define=="function"&&define.amd?define(["exports","vue","element-plus","lodash-es","@element-plus/icons-vue","dayjs"],k):(e=typeof globalThis<"u"?globalThis:e||self,k(e.pandora2={},e.Vue,e.elementPlus,e.lodashEs,e.iconsVue,e.dayjs))})(this,function(exports,vue,elementPlus,lodashEs,iconsVue,dayjs){"use strict";const _interopDefaultLegacy=e=>e&&typeof e=="object"&&"default"in e?e:{default:e},dayjs__default=_interopDefaultLegacy(dayjs),version$1=require("../package.json").version,makeInstaller=(e=[])=>({version:version$1,install:U=>{e.forEach(K=>U.use(K))}}),withInstall=(e,k)=>{if(e.install=U=>{for(const K of[e,...Object.values(k??{})])U.component(K.name,K)},k)for(const[U,K]of Object.entries(k))e[U]=K;return e},withNoopInstall=e=>(e.install=()=>{},e),toString=Object.prototype.toString;function is(e,k){return toString.call(e)===`[object ${k}]`}function isDef(e){return typeof e<"u"}function isUnDef(e){return!isDef(e)}function isObject$1(e){return e!==null&&is(e,"Object")}function isNull(e){return e===null}function isNullOrUnDef(e){return isUnDef(e)||isNull(e)}function isNumber(e){return is(e,"Number")}function isString(e){return is(e,"String")}function isFunction(e){return typeof e=="function"}function isBoolean(e){return is(e,"Boolean")}function isArray(e){return e&&Array.isArray(e)}function createNamespace(e){return[`Pd${e}`]}function _isSlot$2(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!vue.isVNode(e)}function renderColumnProp(e,k){const{prop:U,value:K,label:H,name:G,sortable:X,render:W,...Q}=e,ee={prop:U||K,label:H||G,...Q};let Z;return X&&(Z={header:te=>{const ne=te.column;return vue.createVNode("div",{relId:ne.property},[ne.label,vue.createVNode("span",{class:"caret-wrapper"},[vue.createVNode("i",{class:"sort-caret ascending","on-click":oe=>k.sortIconClick(oe,ne,"ascending")},null),vue.createVNode("i",{class:"sort-caret descending","on-click":oe=>k.sortIconClick(oe,ne,"descending")},null)])])}}),W&&isFunction(W)&&(Z={default:te=>W(vue.toRaw(te.row),te.column,te.$index)}),{columnProps:ee,slots:Z}}function getColumnVNode(e,k,U=null){const{columnProps:K,slots:H}=renderColumnProp(e,k);if(U)return vue.createVNode(elementPlus.ElTableColumn,K,_isSlot$2(U)?U:{default:()=>[U]});const G=H&&(H.default||H.header)?H:"";return vue.createVNode(elementPlus.ElTableColumn,{...K},G)}function useColumnRender(e,k){return e.map(K=>{let H;return K?.columns&&K?.columns.length?(H=K?.columns.map(G=>getColumnVNode(G,k)),getColumnVNode(K,k,H)):getColumnVNode(K,k)})}const PAGE_HEIGHT=50,defaultOption={height:PAGE_HEIGHT,currentPage:1,total:200,pageCount:7,pageSizes:[10,20,30,40,50],pageSize:10,layout:"total, sizes, prev, pager, next, jumper"},getPagerProps=()=>({option:{type:Object,default(){return lodashEs.cloneDeep(defaultOption)}}}),[name$2]=createNamespace("Pagination"),_sfc_main$8=vue.defineComponent({name:name$2,inheritAttrs:!1,props:getPagerProps(),setup(e,{emit:k}){return{handleSizeChange:H=>{k("handleSizeChange",H)},handleCurrentChange:H=>{k("handleCurrentChange",H)}}}}),index_vue_vue_type_style_index_0_lang$3="",_export_sfc=(e,k)=>{const U=e.__vccOpts||e;for(const[K,H]of k)U[K]=H;return U},_hoisted_1$3={class:"vpandora-pagination"};function _sfc_render$4(e,k,U,K,H,G){const X=vue.resolveComponent("el-pagination");return vue.openBlock(),vue.createElementBlock("div",_hoisted_1$3,[vue.createVNode(X,{onSizeChange:e.handleSizeChange,onCurrentChange:e.handleCurrentChange,currentPage:e.option.currentPage,"onUpdate:currentPage":k[0]||(k[0]=W=>e.option.currentPage=W),"page-sizes":e.option.pageSizes,"page-size":e.option.pageSize,"onUpdate:page-size":k[1]||(k[1]=W=>e.option.pageSize=W),"pager-count":e.option.pageCount,layout:e.option.layout,total:e.option.total},null,8,["onSizeChange","onCurrentChange","currentPage","page-sizes","page-size","pager-count","layout","total"])])}const Pagination=_export_sfc(_sfc_main$8,[["render",_sfc_render$4]]),usePagerRender=(e,k,U)=>{let K=null;const G={ref:vue.ref(null),option:e,onHandleSizeChange:k,onHandleCurrentChange:U};return K=vue.createVNode(Pagination,G,null),K},tableProps={data:{type:Array,default(){return[]}},columns:{type:Array,default(){return[]}},sortConfig:{type:Object,default(){return{}}},tableConfig:{type:Object,default(){return{}}}},trim=function(e){return(e||"").replace(/^[\s\uFEFF]+|[\s\uFEFF]+$/g,"")};function hasClass(e,k){return!!e.className.match(new RegExp("(\\s|^)"+k+"(\\s|$)"))}function addClass(e,k){hasClass(e,k)||(e.className=trim(e.className)+" "+k)}function removeClass(e,k){hasClass(e,k)&&(e.className=e.className.replace(new RegExp("(\\s|^)"+k+"(\\s|$)")," "))}const ASC="ascending",DESC="descending",DEFAULT_SORT="descending",SINGLE="single",SORT_ARR=[ASC,DESC];class SortService{activeSort={};defaultSortObj={};_oldActiveSort={};option={sortMode:SINGLE};constructor(k){this.option=k}init(){const k=this.option.userColumnOrder;this._initDefSortObj();for(const U in k)this.defaultSortObj[U]&&(k[U]=this.defaultSortObj[U]);this._oldActiveSort=Object.assign({},k),this.activeSort=Object.assign({},k),this.initIconSort()}initSort(){this._clearSortOrderService(),this._initDefSortObj(),this.sortChange()}_initDefSortObj(){this.option.defaultSorts&&this.option.defaultSorts.forEach(k=>{this.defaultSortObj[k.prop]=k.order})}_getDefaultOrder(k){let U="";return this._oldActiveSort[k]?U=this._oldActiveSort[k]:U=this.option.defaultOrder||DEFAULT_SORT,U}getSortColDom(k){return(this.option.tableInstance?.value).$el.querySelectorAll(`div[relid=${k}]`)}initIconSort(){for(const k in this.activeSort)this.getSortColDom(k).forEach(K=>{addClass(K.parentNode.parentNode,this.activeSort[k])})}getTargetSortKey(k){const U=SORT_ARR.findIndex(K=>K!==k);return SORT_ARR[U]}getCurrentSortKey(k){let U="";const K=`${ASC}|${DESC}`;for(let H=0;H<k.length;H++)new RegExp(K).test(k[H])&&(U=trim(k[H]));return U}_isSingleModel(k){return SINGLE===k}getTargetNode(k){const U=k.target;let K;return U.className==="caret-wrapper"?K=U.parentNode.parentNode.parentNode:U.nodeName==="I"?K=U.parentNode.parentNode.parentNode.parentNode:U.nodeName==="DIV"&&U.attributes.getNamedItem("relid")?K=U.parentNode.parentNode:U.nodeName==="DIV"&&U.className=="cell"&&(K=U.parentNode),K}isNeedOrderChange(k){return this._oldActiveSort[k]}sortOrderService(k,U){this.activeSort[k]=U}_clearSortOrderService(){for(const k in this.activeSort)this.activeSort[k]="",this.clearSortOrderCls(k)}clearSortOrderCls(k){this.getSortColDom(k).forEach(K=>{this.removeAllSortOrderCls(K.parentNode.parentNode)})}changeSortOrderClass(k,U){this.removeAllSortOrderCls(k),addClass(k,U)}removeAllSortOrderCls(k){SORT_ARR.forEach(U=>{removeClass(k,U)})}sortIconClick(k,U,K){const H=this.getTargetNode(k);this._isSingleModel(this.option.sortMode)&&this._clearSortOrderService(),this.changeSortOrderClass(H,K),this.sortOrderService(U.property,K),this.sortChange(),k.stopPropagation(),k.preventDefault()}sortChange(){this.option.sortChange&&isFunction(this.option.sortChange)&&this.option.sortChange(this.getActiveSortValue())}getActiveSortValue(){const k=Object.create(null);for(const U in this.activeSort)this.activeSort[U]!==""&&(k[U]=this.activeSort[U]);return k}executeHeaderClick(k,U){const K=k.property;if(!this.isNeedOrderChange(K))return;const H=this.getTargetNode(U),G=this.getCurrentSortKey(H.classList);let X="";this._isSingleModel(this.option.sortMode)&&this._clearSortOrderService(),G!==""?X=this.getTargetSortKey(G):X=this._getDefaultOrder(K),this.changeSortOrderClass(H,X),this.sortOrderService(K,X),this.sortChange()}}function useSortService(e,k,U){const K=()=>{const G=Object.create([]);return k.map(X=>{X.sortable&&X.sortable!==void 0&&(G[X.value]="")}),G};return e.userColumnOrder=K(),e.tableInstance=U,new SortService(e)}const useTableProps=e=>{const k=vue.ref(),U=vue.ref(e.data),K=e.tableConfig,H=vue.ref(e.columns),{sortConfig:G,columns:X}=e,W=useSortService(G,X,k),Q=(ee,Z)=>{W.executeHeaderClick(ee,Z)};return vue.watch(()=>e.data,()=>{U.value=e.data,W.init()}),{tableInstance:k,tableConfig:K,currentData:U,columnsProps:H,$sortService:W,handleHeaderClick:Q}};function _isSlot$1(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!vue.isVNode(e)}const[name$1]=createNamespace("Table"),_sfc_main$7=vue.defineComponent({name:name$1,inheritAttrs:!1,props:tableProps,setup(e,{emit:k}){const{tableInstance:U,tableConfig:K,currentData:H,columnsProps:G,$sortService:X,handleHeaderClick:W}=useTableProps(e),{pagination:Q,pageOpt:ee,...Z}=K,te=vue.computed(()=>{let oe={};const re=Object.keys(Z);for(let ae in re)oe[ae]=vue.unref(re[ae]);return oe});vue.onMounted(()=>{X.init()});const ne=oe=>{k("handleSizePageChange",oe)},se=oe=>{k("handleCurrentPageChange",oe)};return()=>{const oe=Object.assign({ref:U,onHeaderClick:W,data:H.value},te.value),re=useColumnRender(G.value,X);let ae=null;return vue.unref(Q)&&(ae=usePagerRender(ee,ne,se)),vue.createVNode("div",{class:"vpandora-table"},[vue.createVNode(elementPlus.ElTable,oe,_isSlot$1(re)?re:{default:()=>[re]}),ae])}}}),index_vue_vue_type_style_index_0_lang$2="",PdTable=withInstall(_sfc_main$7);function useRuleFormItem(e,k="value",U="change",K){const G=vue.getCurrentInstance()?.emit,X=vue.reactive({value:e[k]}),W=vue.readonly(X),Q=Z=>{X.value=Z};return vue.watchEffect(()=>{X.value=e[k]}),[vue.computed({get(){return X.value},set(Z){lodashEs.isEqual(Z,W.value)||(X.value=Z,vue.nextTick(()=>{G?.(U,Z,...vue.toRaw(vue.unref(K))||[])}))}}),Q,W]}const DEFAULT_EXCLUDE_KEYS=["class","style"],LISTENER_PREFIX=/^on[A-Z]/;function entries(e){return Object.keys(e).map(k=>[k,e[k]])}function useAttrs(e={}){const k=vue.getCurrentInstance();if(!k)return{};const{excludeListeners:U=!1,excludeKeys:K=[],excludeDefaultKeys:H=!0}=e,G=vue.shallowRef({}),X=K.concat(H?DEFAULT_EXCLUDE_KEYS:[]);return k.attrs=vue.reactive(k.attrs),vue.watchEffect(()=>{const W=entries(k.attrs).reduce((Q,[ee,Z])=>(!X.includes(ee)&&!(U&&LISTENER_PREFIX.test(ee))&&(Q[ee]=Z),Q),{});G.value=W}),G}/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */function isObject(e){return Object.prototype.toString.call(e)==="[object Object]"}function isPlainObject(e){var k,U;return isObject(e)===!1?!1:(k=e.constructor,k===void 0?!0:(U=k.prototype,!(isObject(U)===!1||U.hasOwnProperty("isPrototypeOf")===!1)))}function t(){return t=Object.assign?Object.assign.bind():function(e){for(var k=1;k<arguments.length;k++){var U=arguments[k];for(var K in U)Object.prototype.hasOwnProperty.call(U,K)&&(e[K]=U[K])}return e},t.apply(this,arguments)}function r(e,k){if(e==null)return{};var U,K,H={},G=Object.keys(e);for(K=0;K<G.length;K++)k.indexOf(U=G[K])>=0||(H[U]=e[U]);return H}const n={silent:!1,logLevel:"warn"},i=["validator"],o=Object.prototype,a=o.toString,s=o.hasOwnProperty,u=/^\s*function (\w+)/;function l(e){var k;const U=(k=e?.type)!==null&&k!==void 0?k:e;if(U){const K=U.toString().match(u);return K?K[1]:""}return""}const c=isPlainObject,f=e=>e;let d=f;process.env.NODE_ENV!=="production"&&(d=typeof console<"u"?function(k,U=n.logLevel){n.silent===!1&&console[U](`[VueTypes warn]: ${k}`)}:f);const p=(e,k)=>s.call(e,k),y=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e},v=Array.isArray||function(e){return a.call(e)==="[object Array]"},h=e=>a.call(e)==="[object Function]",b=e=>c(e)&&p(e,"_vueTypes_name"),g=e=>c(e)&&(p(e,"type")||["_vueTypes_name","validator","default","required"].some(k=>p(e,k)));function O(e,k){return Object.defineProperty(e.bind(k),"__original",{value:e})}function m(e,k,U=!1){let K,H=!0,G="";K=c(e)?e:{type:e};const X=b(K)?K._vueTypes_name+" - ":"";if(g(K)&&K.type!==null){if(K.type===void 0||K.type===!0||!K.required&&k===void 0)return H;v(K.type)?(H=K.type.some(W=>m(W,k,!0)===!0),G=K.type.map(W=>l(W)).join(" or ")):(G=l(K),H=G==="Array"?v(k):G==="Object"?c(k):G==="String"||G==="Number"||G==="Boolean"||G==="Function"?function(W){if(W==null)return"";const Q=W.constructor.toString().match(u);return Q?Q[1]:""}(k)===G:k instanceof K.type)}if(!H){const W=`${X}value "${k}" should be of type "${G}"`;return U===!1?(d(W),!1):W}if(p(K,"validator")&&h(K.validator)){const W=d,Q=[];if(d=ee=>{Q.push(ee)},H=K.validator(k),d=W,!H){const ee=(Q.length>1?"* ":"")+Q.join(`
* `);return Q.length=0,U===!1?(d(ee),H):ee}}return H}function j(e,k){const U=Object.defineProperties(k,{_vueTypes_name:{value:e,writable:!0},isRequired:{get(){return this.required=!0,this}},def:{value(H){return H===void 0?(p(this,"default")&&delete this.default,this):h(H)||m(this,H,!0)===!0?(this.default=v(H)?()=>[...H]:c(H)?()=>Object.assign({},H):H,this):(d(`${this._vueTypes_name} - invalid default value: "${H}"`),this)}}}),{validator:K}=U;return h(K)&&(U.validator=O(K,U)),U}function _(e,k){const U=j(e,k);return Object.defineProperty(U,"validate",{value(K){return h(this.validator)&&d(`${this._vueTypes_name} - calling .validate() will overwrite the current custom validator function. Validator info:
${JSON.stringify(this)}`),this.validator=O(K,this),this}})}function T(e,k,U){const K=function(Q){const ee={};return Object.getOwnPropertyNames(Q).forEach(Z=>{ee[Z]=Object.getOwnPropertyDescriptor(Q,Z)}),Object.defineProperties({},ee)}(k);if(K._vueTypes_name=e,!c(U))return K;const{validator:H}=U,G=r(U,i);if(h(H)){let{validator:Q}=K;Q&&(Q=(W=(X=Q).__original)!==null&&W!==void 0?W:X),K.validator=O(Q?function(ee){return Q.call(this,ee)&&H.call(this,ee)}:H,K)}var X,W;return Object.assign(K,G)}function $(e){return e.replace(/^(?!\s*$)/gm,"  ")}const w=()=>_("any",{}),P=()=>_("function",{type:Function}),x=()=>_("boolean",{type:Boolean}),E=()=>_("string",{type:String}),N=()=>_("number",{type:Number}),q=()=>_("array",{type:Array}),A=()=>_("object",{type:Object}),V=()=>j("integer",{type:Number,validator:e=>y(e)}),S=()=>j("symbol",{validator:e=>typeof e=="symbol"});function D(e,k="custom validation failed"){if(typeof e!="function")throw new TypeError("[VueTypes error]: You must provide a function as argument");return j(e.name||"<<anonymous function>>",{type:null,validator(U){const K=e(U);return K||d(`${this._vueTypes_name} - ${k}`),K}})}function L(e){if(!v(e))throw new TypeError("[VueTypes error]: You must provide an array as argument.");const k=`oneOf - value should be one of "${e.join('", "')}".`,U=e.reduce((K,H)=>{if(H!=null){const G=H.constructor;K.indexOf(G)===-1&&K.push(G)}return K},[]);return j("oneOf",{type:U.length>0?U:void 0,validator(K){const H=e.indexOf(K)!==-1;return H||d(k),H}})}function F(e){if(!v(e))throw new TypeError("[VueTypes error]: You must provide an array as argument");let k=!1,U=[];for(let H=0;H<e.length;H+=1){const G=e[H];if(g(G)){if(b(G)&&G._vueTypes_name==="oneOf"&&G.type){U=U.concat(G.type);continue}if(h(G.validator)&&(k=!0),G.type===!0||!G.type){d('oneOfType - invalid usage of "true" or "null" as types.');continue}U=U.concat(G.type)}else U.push(G)}U=U.filter((H,G)=>U.indexOf(H)===G);const K=U.length>0?U:null;return j("oneOfType",k?{type:K,validator(H){const G=[],X=e.some(W=>{const Q=m(b(W)&&W._vueTypes_name==="oneOf"?W.type||null:W,H,!0);return typeof Q=="string"&&G.push(Q),Q===!0});return X||d(`oneOfType - provided value does not match any of the ${G.length} passed-in validators:
${$(G.join(`
`))}`),X}}:{type:K})}function Y(e){return j("arrayOf",{type:Array,validator(k){let U="";const K=k.every(H=>(U=m(e,H,!0),U===!0));return K||d(`arrayOf - value validation error:
${$(U)}`),K}})}function B(e){return j("instanceOf",{type:e})}function I(e){return j("objectOf",{type:Object,validator(k){let U="";const K=Object.keys(k).every(H=>(U=m(e,k[H],!0),U===!0));return K||d(`objectOf - value validation error:
${$(U)}`),K}})}function J(e){const k=Object.keys(e),U=k.filter(H=>{var G;return!((G=e[H])===null||G===void 0||!G.required)}),K=j("shape",{type:Object,validator(H){if(!c(H))return!1;const G=Object.keys(H);if(U.length>0&&U.some(X=>G.indexOf(X)===-1)){const X=U.filter(W=>G.indexOf(W)===-1);return d(X.length===1?`shape - required property "${X[0]}" is not defined.`:`shape - required properties "${X.join('", "')}" are not defined.`),!1}return G.every(X=>{if(k.indexOf(X)===-1)return this._vueTypes_isLoose===!0||(d(`shape - shape definition does not include a "${X}" property. Allowed keys: "${k.join('", "')}".`),!1);const W=m(e[X],H[X],!0);return typeof W=="string"&&d(`shape - "${X}" property validation error:
 ${$(W)}`),W===!0})}});return Object.defineProperty(K,"_vueTypes_isLoose",{writable:!0,value:!1}),Object.defineProperty(K,"loose",{get(){return this._vueTypes_isLoose=!0,this}}),K}const M=["name","validate","getter"],R=(()=>{var e;return(e=class{static get any(){return w()}static get func(){return P().def(this.defaults.func)}static get bool(){return x().def(this.defaults.bool)}static get string(){return E().def(this.defaults.string)}static get number(){return N().def(this.defaults.number)}static get array(){return q().def(this.defaults.array)}static get object(){return A().def(this.defaults.object)}static get integer(){return V().def(this.defaults.integer)}static get symbol(){return S()}static get nullable(){return{type:null}}static extend(k){if(v(k))return k.forEach(Q=>this.extend(Q)),this;const{name:U,validate:K=!1,getter:H=!1}=k,G=r(k,M);if(p(this,U))throw new TypeError(`[VueTypes error]: Type "${U}" already defined`);const{type:X}=G;if(b(X))return delete G.type,Object.defineProperty(this,U,H?{get:()=>T(U,X,G)}:{value(...Q){const ee=T(U,X,G);return ee.validator&&(ee.validator=ee.validator.bind(ee,...Q)),ee}});let W;return W=H?{get(){const Q=Object.assign({},G);return K?_(U,Q):j(U,Q)},enumerable:!0}:{value(...Q){const ee=Object.assign({},G);let Z;return Z=K?_(U,ee):j(U,ee),ee.validator&&(Z.validator=ee.validator.bind(Z,...Q)),Z},enumerable:!0},Object.defineProperty(this,U,W)}}).defaults={},e.sensibleDefaults=void 0,e.config=n,e.custom=D,e.oneOf=L,e.instanceOf=B,e.oneOfType=F,e.arrayOf=Y,e.objectOf=I,e.shape=J,e.utils={validate:(k,U)=>m(U,k,!0)===!0,toType:(k,U,K=!1)=>K?_(k,U):j(k,U)},e})();function z(e={func:()=>{},bool:!0,string:"",number:0,array:()=>[],object:()=>({}),integer:0}){var k;return(k=class extends R{static get sensibleDefaults(){return t({},this.defaults)}static set sensibleDefaults(U){this.defaults=U!==!1?t({},U!==!0?U:e):{}}}).defaults=t({},e),k}class C extends z(){}const propTypes=z({func:void 0,bool:void 0,string:void 0,number:void 0,object:void 0,integer:void 0});propTypes.extend([{name:"style",getter:!0,type:[String,Object],default:void 0},{name:"VNodeChild",getter:!0,type:void 0}]);const _sfc_main$6=vue.defineComponent({name:"ApiSelect",components:{ElSelect:elementPlus.ElSelect},inheritAttrs:!1,props:{value:[Array,Object,String,Number],numberToString:propTypes.bool,api:{type:Function,default:null},params:{type:Object,default:()=>({})},resultField:propTypes.string.def(""),labelField:propTypes.string.def("label"),valueField:propTypes.string.def("value"),immediate:propTypes.bool.def(!0),alwaysLoad:propTypes.bool.def(!1)},emits:["options-change","change"],setup(e,{emit:k}){const U=vue.ref([]),K=vue.ref(!1),H=vue.ref(!0),G=vue.ref([]),X=useAttrs(),[W]=useRuleFormItem(e,"value","change",G),Q=vue.computed(()=>{const{labelField:se,valueField:oe,numberToString:re}=e;return vue.unref(U).reduce((ae,ie)=>{if(ie){const de=ie[oe];ae.push({...lodashEs.omit(ie,[se,oe]),label:ie[se],value:re?`${de}`:de})}return ae},[])});vue.watchEffect(()=>{e.immediate&&!e.alwaysLoad&&ee()}),vue.watch(()=>e.params,()=>{!vue.unref(H)&&ee()},{deep:!0});async function ee(){const se=e.api;if(!(!se||!isFunction(se))){U.value=[];try{K.value=!0;const oe=await se(e.params);if(Array.isArray(oe)){U.value=oe,te();return}e.resultField&&(U.value=lodashEs.get(oe,e.resultField)||[]),te()}catch(oe){console.warn(oe)}finally{K.value=!1}}}async function Z(se){se&&(e.alwaysLoad?await ee():!e.immediate&&vue.unref(H)&&(await ee(),H.value=!1))}function te(){k("options-change",vue.unref(Q))}function ne(se,...oe){G.value=oe}return{state:W,attrs:X,getOptions:Q,loading:K,handleFetch:Z,handleChange:ne}}}),_hoisted_1$2=vue.createTextVNode(" \u6CA1\u6709\u53D1\u73B0\u6570\u636E ");function _sfc_render$3(e,k,U,K,H,G){const X=vue.resolveComponent("el-option"),W=vue.resolveComponent("Loading"),Q=vue.resolveComponent("el-select");return vue.openBlock(),vue.createBlock(Q,vue.mergeProps({onVisibleChange:e.handleFetch},e.$attrs,{onChange:e.handleChange,value:e.state,"onUpdate:value":k[0]||(k[0]=ee=>e.state=ee)}),vue.createSlots({default:vue.withCtx(()=>[(vue.openBlock(!0),vue.createElementBlock(vue.Fragment,null,vue.renderList(e.getOptions,ee=>(vue.openBlock(),vue.createBlock(X,{key:ee.value,label:ee.label,value:ee.value},null,8,["label","value"]))),128))]),_:2},[e.loading?{name:"suffixIcon",fn:vue.withCtx(()=>[vue.createVNode(W)])}:void 0,e.loading?{name:"notFoundContent",fn:vue.withCtx(()=>[vue.createElementVNode("span",null,[vue.createVNode(W),_hoisted_1$2])])}:void 0]),1040,["onVisibleChange","onChange","value"])}const ApiSelect=_export_sfc(_sfc_main$6,[["render",_sfc_render$3]]),componentMap=new Map;componentMap.set("Autocomplete",elementPlus.ElAutocomplete),componentMap.set("Button",elementPlus.ElButton),componentMap.set("Checkbox",elementPlus.ElCheckbox),componentMap.set("CheckboxGroup",elementPlus.ElCheckboxGroup),componentMap.set("Cascader",elementPlus.ElCascader),componentMap.set("DatePicker",elementPlus.ElDatePicker),componentMap.set("Input",elementPlus.ElInput),componentMap.set("InputNumber",elementPlus.ElInputNumber),componentMap.set("TimePicker",elementPlus.ElTimePicker),componentMap.set("TimeSelect",elementPlus.ElTimeSelect),componentMap.set("Slider",elementPlus.ElSlider),componentMap.set("Select",elementPlus.ElSelect),componentMap.set("SelectOption",elementPlus.ElOption),componentMap.set("Switch",elementPlus.ElSwitch),componentMap.set("Radio",elementPlus.ElRadio),componentMap.set("RadioGroup",elementPlus.ElRadioGroup),componentMap.set("Rate",elementPlus.ElRate),componentMap.set("Divider",elementPlus.ElDivider),componentMap.set("ApiSelect",ApiSelect);function add(e,k){componentMap.set(e,k)}function del(e){componentMap.delete(e)}function getDynamicProps(e){const k={};return Object.keys(e).map(U=>{k[U]=vue.unref(e[U])}),k}function deepMerge(e={},k={}){let U;for(U in k)e[U]=isObject$1(e[U])?deepMerge(e[U],k[U]):e[U]=k[U];return e}const projectName="Pandora 2.0";function error(e){throw new Error(`[${projectName} error]:${e}`)}function createPlaceholderMessage(e){return e.includes("Input")||e.includes("Complete")?"\u8BF7\u8F93\u5165\u5185\u5BB9":e.includes("Picker")||e.includes("Select")||e.includes("Cascader")||e.includes("Checkbox")||e.includes("Radio")||e.includes("Switch")?"\u8BF7\u9009\u62E9\u5185\u5BB9":""}const DATE_TYPE=["DatePicker","MonthPicker","WeekPicker","TimePicker"];function genType(){return[...DATE_TYPE,"RangePicker"]}function handleInputNumberValue(e,k){return e&&["Input","InputPassword","InputSearch","InputTextArea"].includes(e)&&k&&isNumber(k)?`${k}`:k}const dateItemType=genType(),defaultValueComponents=["Input","InputPassword","InputSearch","InputTextArea"];function getSlot(e,k="default",U){if(!e||!Reflect.has(e,k))return null;if(!isFunction(e[k]))return console.error(`${k} is not a function!`),null;const K=e[k];return K?K(U):null}const props={color:{type:String,default:"#ffffff"},fontSize:{type:String,default:"14px"},tabindex:{type:Boolean},placement:{type:String,default:"right"},content:{type:[Array,String]}},_sfc_main$5=vue.defineComponent({name:"BasicHelp",components:{ElTooltip:elementPlus.ElTooltip},props,setup(e,{slots:k}){const U="pandora-basic-help",K=()=>`<div style="color: ${e.color};fontSize: ${e.fontSize};">${e.content}</div>`;return()=>vue.createVNode(elementPlus.ElTooltip,{content:K(),rawContent:!0,placement:e.placement},{default:()=>[vue.createVNode("span",{class:U},[getSlot(k)||vue.createVNode(iconsVue.Warning,null,null)])]})}}),BasicHelp_vue_vue_type_style_index_0_lang="";function _isSlot(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!vue.isVNode(e)}const _sfc_main$4=vue.defineComponent({name:"PandoraBasicFormItem",inheritAttrs:!1,props:{schema:{type:Object,default:()=>({})},formModel:{type:Object,default:()=>({})},formProps:{type:Object,default:()=>({})},setFormModel:{type:Function,default:null},allDefaultValues:{type:Object,default:()=>({})},tableAction:{type:Object},formActionType:{type:Object}},setup(e,{slots:k}){const{schema:U}=vue.toRefs(e),K=vue.computed(()=>{const{schema:te,tableAction:ne,formModel:se,formActionType:oe}=e,{componentProps:re={}}=te;return isFunction(re)?re({schema:te,tableAction:ne,formModel:se,formActionType:oe})??{}:re}),H=vue.computed(()=>{const{allDefaultValues:te,formModel:ne,schema:se}=e,{mergeDynamicData:oe}=e.formProps;return{field:se.field,model:ne,values:{...oe,...te,...ne},schema:se}}),G=vue.computed(()=>{const{disabled:te}=e.formProps,{dynamicDisabled:ne}=e.schema,{disabled:se=!1}=vue.unref(K);let oe=!!te||se;return isBoolean(ne)&&(oe=ne),isFunction(ne)&&(oe=ne(vue.unref(H))),oe});function X(){const{show:te,ifShow:ne}=e.schema,{showAdvancedButton:se}=e.formProps,oe=se&&isBoolean(e.schema.isAdvanced)?e.schema.isAdvanced:!0;let re=!0,ae=!0;return isBoolean(te)&&(re=te),isBoolean(ne)&&(ae=ne),isFunction(te)&&(re=te(vue.unref(H))),isFunction(ne)&&(ae=ne(vue.unref(H))),re=re&&oe,{isShow:re,isIfShow:ae}}const W=te=>{let ne;const{schema:se,tableAction:oe,formModel:re,formActionType:ae}=e;let{componentProps:ie={}}=vue.unref(se);isFunction(ie)&&(ie=ie({schema:se,tableAction:oe,formModel:re,formActionType:ae})??{});const de=ie.options;return te==="CheckboxGroup"?(ne=de.map(({label:ue,value:le})=>{const fe=componentMap.get("Checkbox");return vue.createVNode(fe,{label:le,key:le},_isSlot(ue)?ue:{default:()=>[ue]})}),ne):(te==="Select"?ne=de.map(({label:ue,value:le})=>{const fe=componentMap.get("SelectOption");return vue.createVNode(fe,{label:ue,value:le,key:le},_isSlot(ue)?ue:{default:()=>[ue]})}):te==="RadioGroup"&&(ne=de.map(({label:ue,value:le})=>{const fe=componentMap.get("Radio");return vue.createVNode(fe,{label:le,key:le},_isSlot(ue)?ue:{default:()=>[ue]})})),ne)},Q=()=>{const{renderComponentContent:te,component:ne,field:se,changeEvent:oe="change",valueField:re}=e.schema,ae=ne&&["Switch","Checkbox"].includes(ne),ie=`on${lodashEs.upperFirst(oe)}`,de={[ie]:(...pe)=>{const[ge]=pe;le[ie]&&le[ie](...pe);const _e=ge?ge.target:null,Ce=_e?ae?_e.checked:_e.value:ge;e.setFormModel(se,Ce)}},ue=componentMap.get(ne),le={getPopupContainer:pe=>pe.parentNode,...vue.unref(K),disabled:vue.unref(G)},{autoSetPlaceHolder:fe}=e.formProps;!le.disabled&&fe&&ne&&(le.placeholder=vue.unref(K)?.placeholder||createPlaceholderMessage(ne)),le.placeholder=vue.unref(K)?.placeholder,le.codeField=se,le.formValues=vue.unref(H);const ye={[re||(ae?"checked":"value")]:e.formModel[se]},be={...le,...de,...ye};if(!te){let pe;return vue.createVNode(ue,vue.mergeProps(be,{modelValue:e.formModel[se],"onUpdate:modelValue":ge=>e.formModel[se]=ge}),_isSlot(pe=W(ne))?pe:{default:()=>[pe]})}const Se=isFunction(te)?{...te(vue.unref(H))}:{default:()=>te};return vue.createVNode(ue,vue.mergeProps(be,{modelValue:e.formModel[se],"onUpdate:modelValue":pe=>e.formModel[se]=pe}),_isSlot(Se)?Se:{default:()=>[Se]})},ee=()=>{const{label:te,helpMessage:ne,helpComponentProps:se,subLabel:oe}=e.schema,re=oe?vue.createVNode("span",null,[te,vue.createTextVNode(" "),vue.createVNode("span",{class:"text-secondary"},[oe])]):te,ae=isFunction(ne)?ne(vue.unref(H)):ne;return ae!==void 0||Array.isArray(ae)&&ae?.length>0?vue.createVNode("span",null,[re,vue.createVNode(_sfc_main$5,vue.mergeProps({placement:"top",content:ae},se),null)]):vue.createVNode("span",null,[re])},Z=()=>{const{label:te,slot:ne,rules:se,render:oe,field:re,suffix:ae,itemProps:ie,component:de}=e.schema;if(de==="Divider"){let ue;const le=deepMerge({contentPosition:"left"},{...vue.unref(K)});return vue.createVNode(elementPlus.ElCol,{span:24},{default:()=>[vue.createVNode(elementPlus.ElDivider,le,_isSlot(ue=ee())?ue:{default:()=>[ue]})]})}else{const ue=vue.unref(H),le=()=>ne?getSlot(k,ne,ue):oe?oe(ue):Q(),fe=!!ae,he=isFunction(ae)?ae(vue.unref(H)):ae,ye={default:()=>vue.createVNode("div",{style:"display:flex;width:100%;"},[vue.createVNode("div",{style:"flex:1;"},[le()]),fe&&vue.createVNode("span",{class:"suffix"},[he])]),label:()=>ee()};return vue.createVNode(elementPlus.ElFormItem,vue.mergeProps({prop:re,label:te,rules:se},ie),{default:()=>[vue.createTextVNode(" ")],...ye})}};return vue.onMounted(()=>{const{field:te,defaultValue:ne=""}=vue.unref(U);e.setFormModel(te,ne)}),()=>{let te;const{colProps:ne={},colSlot:se,renderColContent:oe,component:re}=e.schema;if(!componentMap.has(re))return console.error(`FormItem component:${re} is an unregistered component Key`),null;const{baseColProps:ae={}}=e.formProps,ie={...ae,...ne},{isShow:de}=X(),ue=vue.unref(H),le=()=>se?getSlot(k,se,ue):oe?oe(ue):Z();return vue.withDirectives(vue.createVNode(elementPlus.ElCol,ie,_isSlot(te=le())?te:{default:()=>[te]}),[[vue.vShow,de]])}}}),_sfc_main$3=vue.defineComponent({__name:"BasicArrow",props:{expand:{type:Boolean},up:{type:Boolean},down:{type:Boolean},inset:{type:Boolean}},setup(e){const k=e,U="pandora-basic-arrow",K=vue.computed(()=>{const{expand:H,up:G,down:X,inset:W}=k;return[U,{[`${U}--active`]:H,up:G,inset:W,down:X}]});return(H,G)=>{const X=vue.resolveComponent("ArrowDown");return vue.openBlock(),vue.createElementBlock("span",{class:vue.normalizeClass(vue.unref(K))},[vue.createVNode(X,{style:vue.normalizeStyle(H.$attrs.iconStyle)},null,8,["style"])],2)}}}),BasicArrow_vue_vue_type_style_index_0_scoped_b5173730_lang="",BasicArrow=_export_sfc(_sfc_main$3,[["__scopeId","data-v-b5173730"]]);function createContext(e,k=Symbol(),U={}){const{readonly:K=!0,createProvider:H=!1,native:G=!1}=U,X=vue.reactive(e),W=K?vue.readonly(X):X;return!H&&vue.provide(k,G?e:W),{state:X}}function useContext(e=Symbol(),k){return vue.inject(e,k||{})}const key=Symbol();function createFormContext(e){return createContext(e,key)}function useFormContext(){return useContext(key)}const _sfc_main$2=vue.defineComponent({name:"BasicFormAction",components:{BasicArrow,ElCol:elementPlus.ElCol,ElButton:elementPlus.ElButton},props:{showActionButtonGroup:propTypes.bool.def(!0),showResetButton:propTypes.bool.def(!0),showSubmitButton:propTypes.bool.def(!0),showAdvancedButton:propTypes.bool.def(!0),actionColStyle:{type:Object,default:()=>({})},resetButtonOptions:{type:Object,default:()=>({})},submitButtonOptions:{type:Object,default:()=>({})},actionColOptions:{type:Object,default:()=>({})},actionSpan:propTypes.number.def(6),isAdvanced:propTypes.bool,hideAdvanceBtn:propTypes.bool.def(!1)},emits:["toggle-advanced"],setup(e,{emit:k}){const U=vue.computed(()=>{const{showAdvancedButton:W,actionSpan:Q,actionColOptions:ee}=e,Z=24-Q,te=W?{span:Z<6?24:Z}:{};return{span:W?6:4,...te,...ee}}),K=vue.computed(()=>{const{actionColStyle:W}=e;return{width:"100%","text-align":W.textAlign?W.textAlign:"right"}}),H=vue.computed(()=>Object.assign({label:"\u91CD\u7F6E"},e.resetButtonOptions)),G=vue.computed(()=>Object.assign({label:"\u67E5\u8BE2"},e.submitButtonOptions));function X(){k("toggle-advanced")}return{actionColOpt:U,getResetBtnOptions:H,getSubmitBtnOptions:G,toggleAdvanced:X,getActionStyle:K,...useFormContext()}}});function _sfc_render$2(e,k,U,K,H,G){const X=vue.resolveComponent("el-button"),W=vue.resolveComponent("BasicArrow"),Q=vue.resolveComponent("el-col");return e.showActionButtonGroup?(vue.openBlock(),vue.createBlock(Q,vue.normalizeProps(vue.mergeProps({key:0},e.actionColOpt)),{default:vue.withCtx(()=>[vue.createElementVNode("div",{style:vue.normalizeStyle(e.getActionStyle)},[vue.renderSlot(e.$slots,"resetBefore"),e.showResetButton?(vue.openBlock(),vue.createBlock(X,vue.mergeProps({key:0,type:"default"},e.getResetBtnOptions,{onClick:e.resetAction}),{default:vue.withCtx(()=>[vue.createTextVNode(vue.toDisplayString(e.getResetBtnOptions.label),1)]),_:1},16,["onClick"])):vue.createCommentVNode("",!0),vue.renderSlot(e.$slots,"submitBefore"),e.showSubmitButton?(vue.openBlock(),vue.createBlock(X,vue.mergeProps({key:1,type:"primary"},e.getSubmitBtnOptions,{onClick:e.submitAction}),{default:vue.withCtx(()=>[vue.createTextVNode(vue.toDisplayString(e.getSubmitBtnOptions.label),1)]),_:1},16,["onClick"])):vue.createCommentVNode("",!0),vue.renderSlot(e.$slots,"advanceBefore"),e.showAdvancedButton&&!e.hideAdvanceBtn?(vue.openBlock(),vue.createBlock(X,{key:2,type:"text",size:"small",onClick:e.toggleAdvanced},{default:vue.withCtx(()=>[vue.createTextVNode(vue.toDisplayString(e.isAdvanced?"\u6536\u8D77":"\u5C55\u5F00")+" ",1),vue.createVNode(W,{class:"ml-1",expand:!e.isAdvanced,up:""},null,8,["expand"])]),_:1},8,["onClick"])):vue.createCommentVNode("",!0),vue.renderSlot(e.$slots,"advanceAfter")],4)]),_:3},16)):vue.createCommentVNode("",!0)}const FormAction=_export_sfc(_sfc_main$2,[["render",_sfc_render$2]]),dateUtil=dayjs__default.default;function tryDeconstructArray(e,k,U){const K=/^\[(.+)\]$/;if(K.test(e)){const H=e.match(K);if(H&&H[1]){const G=H[1].split(",");return k=Array.isArray(k)?k:[k],G.forEach((X,W)=>{lodashEs.set(U,X.trim(),k[W])}),!0}}}function tryDeconstructObject(e,k,U){const K=/^\{(.+)\}$/;if(K.test(e)){const H=e.match(K);if(H&&H[1]){const G=H[1].split(",");return k=isObject$1(k)?k:{},G.forEach(X=>{lodashEs.set(U,X.trim(),k[X.trim()])}),!0}}}function useFormValues({defaultValueRef:e,getSchema:k,getProps:U,formModel:K}){function H(W){if(!isObject$1(W))return{};const Q={};for(const ee of Object.entries(W)){let[,Z]=ee;const[te]=ee;if(!te||isArray(Z)&&Z.length===0||isFunction(Z))continue;const ne=vue.unref(U).transformDateFunc;isObject$1(Z)&&(Z=ne?.(Z)),isArray(Z)&&Z[0]?.format&&Z[1]?.format&&(Z=Z.map(se=>ne?.(se))),isString(Z)&&(Z=Z.trim()),!tryDeconstructArray(te,Z,Q)&&!tryDeconstructObject(te,Z,Q)&&lodashEs.set(Q,te,Z)}return G(Q)}function G(W){const Q=vue.unref(U).fieldMapToTime;if(!Q||!Array.isArray(Q))return W;for(const[ee,[Z,te],ne="YYYY-MM-DD"]of Q){if(!ee||!Z||!te||!W[ee])continue;const[se,oe]=W[ee];W[Z]=dateUtil(se).format(ne),W[te]=dateUtil(oe).format(ne),Reflect.deleteProperty(W,ee)}return W}function X(){const W=vue.unref(k),Q={};W.forEach(ee=>{const{defaultValue:Z}=ee;isNullOrUnDef(Z)||(Q[ee.field]=Z,K[ee.field]=Z,K[ee.field]===void 0&&(K[ee.field]=Z))}),e.value=lodashEs.cloneDeep(Q)}return{handleFormValues:H,initDefault:X}}function useFormEvents({emit,getProps,formModel,getSchema,defaultValueRef,formElRef,schemaRef,handleFormValues}){async function resetFields(){const{resetFunc:e,submitOnReset:k}=vue.unref(getProps);e&&isFunction(e)&&await e(),vue.unref(formElRef)&&(Object.keys(formModel).forEach(K=>{const H=vue.unref(getSchema).find(W=>W.field===K),G=H?.component&&defaultValueComponents.includes(H.component),X=lodashEs.cloneDeep(defaultValueRef.value[K]);formModel[K]=G?X||"":X}),vue.nextTick(()=>clearValidate()),emit("reset",vue.toRaw(formModel)),k&&handleSubmit())}async function setFieldsValue(values){const fields=vue.unref(getSchema).map(e=>e.field).filter(Boolean),delimiter=".",nestKeyArray=fields.filter(e=>e.indexOf(delimiter)>=0),validKeys=[];Object.keys(values).forEach(key=>{const schema=vue.unref(getSchema).find(e=>e.field===key);let value=values[key];const hasKey=Reflect.has(values,key);if(value=handleInputNumberValue(schema?.component,value),hasKey&&fields.includes(key)){if(itemIsDateType(key))if(Array.isArray(value)){const e=[];for(const k of value)e.push(k?dateUtil(k):null);formModel[key]=e}else{const{componentProps:e}=schema||{};let k=e;typeof e=="function"&&(k=k({formModel})),formModel[key]=value?k?.valueFormat?value:dateUtil(value):null}else formModel[key]=value;validKeys.push(key)}else nestKeyArray.forEach(nestKey=>{try{const value=eval("values"+delimiter+nestKey);isDef(value)&&(formModel[nestKey]=value,validKeys.push(nestKey))}catch(e){isDef(defaultValueRef.value[nestKey])&&(formModel[nestKey]=lodashEs.cloneDeep(defaultValueRef.value[nestKey]))}})}),validateFields(validKeys).catch(e=>{})}async function removeSchemaByFiled(e){const k=lodashEs.cloneDeep(vue.unref(getSchema));if(!e)return;let U=isString(e)?[e]:e;isString(e)&&(U=[e]);for(const K of U)_removeSchemaByFiled(K,k);schemaRef.value=k}function _removeSchemaByFiled(e,k){if(isString(e)){const U=k.findIndex(K=>K.field===e);U!==-1&&(delete formModel[e],k.splice(U,1))}}async function appendSchemaByField(e,k,U=!1){const K=lodashEs.cloneDeep(vue.unref(getSchema)),H=K.findIndex(G=>G.field===k);if(!k||H===-1||U){U?K.unshift(e):K.push(e),schemaRef.value=K,_setDefaultValue(e);return}H!==-1&&K.splice(H+1,0,e),_setDefaultValue(e),schemaRef.value=K}async function resetSchema(e){let k=[];if(isObject$1(e)&&k.push(e),isArray(e)&&(k=[...e]),!k.every(K=>K.component==="Divider"||Reflect.has(K,"field")&&K.field)){error("All children of the form Schema array that need to be updated must contain the `field` field");return}schemaRef.value=k}async function updateSchema(e){let k=[];if(isObject$1(e)&&k.push(e),isArray(e)&&(k=[...e]),!k.every(H=>H.component==="Divider"||Reflect.has(H,"field")&&H.field)){error("All children of the form Schema array that need to be updated must contain the `field` field");return}const K=[];k.forEach(H=>{vue.unref(getSchema).forEach(G=>{if(G.field===H.field){const X=deepMerge(G,H);K.push(X)}else K.push(G)})}),_setDefaultValue(K),schemaRef.value=lodashEs.uniqBy(K,"field")}function _setDefaultValue(e){let k=[];isObject$1(e)&&k.push(e),isArray(e)&&(k=[...e]);const U={},K=getFieldsValue();k.forEach(H=>{H.component!="Divider"&&Reflect.has(H,"field")&&H.field&&!isNullOrUnDef(H.defaultValue)&&!(H.field in K)&&(U[H.field]=H.defaultValue)}),setFieldsValue(U)}function getFieldsValue(){return vue.unref(formElRef)?handleFormValues(vue.toRaw(vue.unref(formModel))):{}}function itemIsDateType(e){return vue.unref(getSchema).some(k=>k.field===e?dateItemType.includes(k.component):!1)}async function validateFields(e,k){return vue.unref(formElRef)?.validateFields(e,k)}async function validate(e){return await vue.unref(formElRef)?.validate(e)}async function clearValidate(e){await vue.unref(formElRef)?.clearValidate(e)}async function scrollToField(e,k){await vue.unref(formElRef)?.scrollToField(e,k)}async function handleSubmit(e){e&&e.preventDefault();const{submitFunc:k}=vue.unref(getProps);if(k&&isFunction(k)){await k();return}!vue.unref(formElRef)||await validate(function(K,H){if(K){console.log("submit!");const G=handleFormValues(vue.toRaw(vue.unref(formModel)));emit("submit",G)}else console.error("error submit!",H)})}return{handleSubmit,clearValidate,validate,validateFields,getFieldsValue,updateSchema,resetSchema,appendSchemaByField,removeSchemaByFiled,resetFields,setFieldsValue,scrollToField}}async function useAutoFocus({getSchema:e,getProps:k,formElRef:U,isInitedDefault:K}){vue.watchEffect(async()=>{if(vue.unref(K)||!vue.unref(k).autoFocusFirstItem)return;await vue.nextTick();const H=vue.unref(e),G=vue.unref(U),X=G?.$el;if(!G||!X||!H||H.length===0||!H[0].component.includes("Input"))return;const Q=X.querySelector(".ant-row:first-child input");!Q||Q?.focus()})}var _a;const isClient=typeof window<"u";isClient&&((_a=window?.navigator)==null?void 0:_a.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function resolveUnref(e){return typeof e=="function"?e():vue.unref(e)}function createFilterWrapper(e,k){function U(...K){e(()=>k.apply(this,K),{fn:k,thisArg:this,args:K})}return U}function debounceFilter(e,k={}){let U,K;return G=>{const X=resolveUnref(e),W=resolveUnref(k.maxWait);if(U&&clearTimeout(U),X<=0||W!==void 0&&W<=0)return K&&(clearTimeout(K),K=null),G();W&&!K&&(K=setTimeout(()=>{U&&clearTimeout(U),K=null,G()},W)),U=setTimeout(()=>{K&&clearTimeout(K),K=null,G()},X)}}function useDebounceFn(e,k=200,U={}){return createFilterWrapper(debounceFilter(k,U),e)}function tryOnUnmounted(e){vue.getCurrentInstance()&&vue.onUnmounted(e)}const FormBasicProps={model:{type:Object,default:{}},labelWidth:{type:[Number,String],default:0},fieldMapToTime:{type:Array,default:()=>[]},schemas:{type:[Array],default:()=>[]},mergeDynamicData:{type:Object,default:null},baseRowStyle:{type:Object},baseColProps:{type:Object},autoSetPlaceHolder:propTypes.bool.def(!0),autoSubmitOnEnter:propTypes.bool.def(!1),submitOnReset:propTypes.bool,submitOnChange:propTypes.bool,size:propTypes.oneOf(["large","default","small"]).def("default"),disabled:propTypes.bool,emptySpan:{type:[Number,Object],default:0},showAdvancedButton:propTypes.bool.def(!1),transformDateFunc:{type:Function,default:e=>e?.format?.("YYYY-MM-DD HH:mm:ss")??e},rulesMessageJoinLabel:propTypes.bool.def(!0),autoAdvancedLine:propTypes.number.def(3),alwaysShowLines:propTypes.number.def(1),showActionButtonGroup:propTypes.bool.def(!0),actionColOptions:Object,showResetButton:propTypes.bool.def(!0),autoFocusFirstItem:propTypes.bool,resetButtonOptions:Object,showSubmitButton:propTypes.bool.def(!0),submitButtonOptions:Object,resetFunc:Function,submitFunc:Function,hideRequiredMark:propTypes.bool,labelAlign:propTypes.string,rowProps:Object,rules:Object};var screenEnum=(e=>(e[e.XS=480]="XS",e[e.SM=576]="SM",e[e.MD=768]="MD",e[e.LG=992]="LG",e[e.XL=1200]="XL",e[e.XXL=1600]="XXL",e))(screenEnum||{});const screenMap=new Map;screenMap.set("XS",480),screenMap.set("SM",576),screenMap.set("MD",768),screenMap.set("LG",992),screenMap.set("XL",1200),screenMap.set("XXL",1600);let globalScreenRef,globalWidthRef,globalRealWidthRef;function useBreakpoint(){return{screenRef:vue.computed(()=>vue.unref(globalScreenRef)),widthRef:globalWidthRef,screenEnum,realWidthRef:globalRealWidthRef}}const BASIC_COL_LEN=24;function useAdvanced({advanceState:e,emit:k,getProps:U,getSchema:K,formModel:H,defaultValueRef:G}){const X=vue.getCurrentInstance(),{realWidthRef:W,screenEnum:Q,screenRef:ee}=useBreakpoint(),Z=vue.computed(()=>{if(!e.isAdvanced)return 0;const re=vue.unref(U).emptySpan||0;if(isNumber(re))return re;if(isObject$1(re)){const{span:ae=0}=re,ie=vue.unref(ee);return re[ie.toLowerCase()]||ae||0}return 0}),te=useDebounceFn(se,30);vue.watch([()=>vue.unref(K),()=>e.isAdvanced,()=>vue.unref(W)],()=>{const{showAdvancedButton:re}=vue.unref(U);re&&te()},{immediate:!0});function ne(re,ae=0,ie=!1){const de=vue.unref(W),ue=parseInt(re.md)||parseInt(re.xs)||parseInt(re.sm)||re.span||BASIC_COL_LEN,le=parseInt(re.lg)||ue,fe=parseInt(re.xl)||le,he=parseInt(re.xxl)||fe;return de<=Q.MD?ae+=ue:de<Q.LG?ae+=le:de<Q.XL?ae+=fe:ae+=he,ie?(e.hideAdvanceBtn=!1,ae<=BASIC_COL_LEN*2?(e.hideAdvanceBtn=!0,e.isAdvanced=!0):ae>BASIC_COL_LEN*2&&ae<=BASIC_COL_LEN*(vue.unref(U).autoAdvancedLine||3)?e.hideAdvanceBtn=!1:e.isLoad||(e.isLoad=!0,e.isAdvanced=!e.isAdvanced),{isAdvanced:e.isAdvanced,itemColSum:ae}):ae>BASIC_COL_LEN*(vue.unref(U).alwaysShowLines||1)?{isAdvanced:e.isAdvanced,itemColSum:ae}:{isAdvanced:!0,itemColSum:ae}}function se(){let re=0,ae=0;const{baseColProps:ie={}}=vue.unref(U);for(const de of vue.unref(K)){const{show:ue,colProps:le}=de;let fe=!0;if(isBoolean(ue)&&(fe=ue),isFunction(ue)&&(fe=ue({schema:de,model:H,field:de.field,values:{...vue.unref(G),...H}})),fe&&(le||ie)){const{itemColSum:he,isAdvanced:ye}=ne({...ie,...le},re);re=he||0,ye&&(ae=re),de.isAdvanced=ye}}X?.proxy?.$forceUpdate(),e.actionSpan=ae%BASIC_COL_LEN+vue.unref(Z),ne(vue.unref(U).actionColOptions||{span:BASIC_COL_LEN},re,!0),k("advanced-change")}function oe(){e.isAdvanced=!e.isAdvanced}return{handleToggleAdvanced:oe}}const[name]=createNamespace("Form"),_sfc_main$1=vue.defineComponent({name,inheritAttrs:!1,props:FormBasicProps,components:{ElForm:elementPlus.ElForm,ElRow:elementPlus.ElRow,FormItem:_sfc_main$4,FormAction},emits:["advanced-change","reset","submit","register","field-value-change"],setup(e,{emit:k,attrs:U}){const K=vue.reactive({}),H=vue.ref({}),G=vue.ref({}),X=vue.ref(null),W=vue.ref(null),Q=vue.ref(!1),ee=vue.reactive({isAdvanced:!0,hideAdvanceBtn:!1,isLoad:!1,actionSpan:6}),Z=vue.computed(()=>({...e,...vue.unref(H)})),te=vue.computed(()=>{const{baseRowStyle:ce={},rowProps:me}=vue.unref(Z);return{style:ce,...me}}),ne=vue.computed(()=>{const{rules:ce={}}=vue.unref(Z);return ce}),se=vue.computed(()=>({...U,...e,...vue.unref(Z)})),oe=vue.computed(()=>{const ce=vue.unref(X)||e.schemas;for(const me of ce){const{defaultValue:ve,component:Ee}=me;if(ve&&dateItemType.includes(Ee))if(!Array.isArray(ve))me.defaultValue=dateUtil(ve);else{const Pe=[];ve.forEach(Te=>{Pe.push(dateUtil(Te))}),me.defaultValue=Pe}}return vue.unref(Z).showAdvancedButton?lodashEs.cloneDeep(ce.filter(me=>me.component!=="Divider")):lodashEs.cloneDeep(ce)}),{initDefault:re,handleFormValues:ae}=useFormValues({getProps:Z,defaultValueRef:G,getSchema:oe,formModel:K}),{handleSubmit:ie,setFieldsValue:de,clearValidate:ue,validate:le,validateFields:fe,getFieldsValue:he,updateSchema:ye,resetSchema:be,appendSchemaByField:Se,removeSchemaByFiled:pe,resetFields:ge,scrollToField:_e}=useFormEvents({emit:k,getProps:Z,formModel:K,getSchema:oe,defaultValueRef:G,formElRef:W,schemaRef:X,handleFormValues:ae});createFormContext({resetAction:ge,submitAction:ie}),vue.watch(()=>vue.unref(Z).model,()=>{const{model:ce}=vue.unref(Z);!ce||de(ce)},{immediate:!0}),vue.watch(()=>vue.unref(Z).schemas,ce=>{be(ce??[])}),vue.watch(()=>oe.value,ce=>{vue.unref(Q)||ce?.length&&(re(),Q.value=!0)}),vue.watch(()=>K,useDebounceFn(()=>{vue.unref(Z).submitOnChange&&ie()},300),{deep:!0});async function Ce(ce){H.value=deepMerge(vue.unref(H)||{},ce)}function Ae(ce,me){K[ce]=me;const{validateTrigger:ve}=vue.unref(se);(!ve||ve==="change")&&fe([ce]).catch(()=>{}),k("field-value-change",ce,me)}function Fe(ce){const{autoSubmitOnEnter:me}=vue.unref(Z);if(!!me&&ce.key==="Enter"&&ce.target&&ce.target instanceof HTMLElement){const ve=ce.target;ve&&ve.tagName&&ve.tagName.toUpperCase()=="INPUT"&&ie()}}const Oe={getFieldsValue:he,setFieldsValue:de,resetFields:ge,updateSchema:ye,resetSchema:be,setProps:Ce,removeSchemaByFiled:pe,appendSchemaByField:Se,clearValidate:ue,validateFields:fe,validate:le,submit:ie,scrollToField:_e};useAutoFocus({getSchema:oe,getProps:Z,isInitedDefault:Q,formElRef:W}),vue.onMounted(()=>{re(),k("register",Oe)});const{handleToggleAdvanced:we}=useAdvanced({advanceState:ee,emit:k,getProps:Z,getSchema:oe,formModel:K,defaultValueRef:G});return{getBindValue:se,handleToggleAdvanced:we,handleEnterPress:Fe,formModel:K,defaultValueRef:G,advanceState:ee,getRow:te,getProps:Z,getRules:ne,formRef:W,getSchema:oe,formActionType:Oe,setFormModel:Ae,getFormActionBindProps:vue.computed(()=>({...Z.value,...ee})),...Oe}}}),index_vue_vue_type_style_index_0_lang$1="",_hoisted_1$1={class:"vpandora-form"};function _sfc_render$1(e,k,U,K,H,G){const X=vue.resolveComponent("FormItem"),W=vue.resolveComponent("FormAction"),Q=vue.resolveComponent("el-row"),ee=vue.resolveComponent("el-Form");return vue.openBlock(),vue.createElementBlock("div",_hoisted_1$1,[vue.createVNode(ee,vue.mergeProps(e.getBindValue,{rules:e.getRules,ref:"formRef",model:e.formModel,onKeypress:vue.withKeys(e.handleEnterPress,["enter"])}),{default:vue.withCtx(()=>[vue.createVNode(Q,vue.normalizeProps(vue.guardReactiveProps(e.getRow)),{default:vue.withCtx(()=>[vue.renderSlot(e.$slots,"formHeader"),(vue.openBlock(!0),vue.createElementBlock(vue.Fragment,null,vue.renderList(e.getSchema,Z=>(vue.openBlock(),vue.createBlock(X,{key:Z.field,tableAction:e.tableAction,formActionType:e.formActionType,schema:Z,formProps:e.getProps,allDefaultValues:e.defaultValueRef,formModel:e.formModel,setFormModel:e.setFormModel},vue.createSlots({_:2},[vue.renderList(Object.keys(e.$slots),te=>({name:te,fn:vue.withCtx(ne=>[vue.renderSlot(e.$slots,te,vue.normalizeProps(vue.guardReactiveProps(ne||{})))])}))]),1032,["tableAction","formActionType","schema","formProps","allDefaultValues","formModel","setFormModel"]))),128)),vue.createVNode(W,vue.mergeProps(e.getFormActionBindProps,{onToggleAdvanced:e.handleToggleAdvanced}),vue.createSlots({_:2},[vue.renderList(["resetBefore","submitBefore","advanceBefore","advanceAfter"],Z=>({name:Z,fn:vue.withCtx(te=>[vue.renderSlot(e.$slots,Z,vue.normalizeProps(vue.guardReactiveProps(te||{})))])}))]),1040,["onToggleAdvanced"]),vue.renderSlot(e.$slots,"formFooter")]),_:3},16)]),_:3},16,["rules","model","onKeypress"])])}const Form=_export_sfc(_sfc_main$1,[["render",_sfc_render$1]]);function isProdMode(){return!0}function useForm(e){const k=vue.ref(null),U=vue.ref(!1);async function K(){const X=vue.unref(k);return X||error("The form instance has not been obtained, please make sure that the form has been rendered when performing the form operation!"),await vue.nextTick(),X}return[X=>{vue.onUnmounted(()=>{k.value=null,U.value=null}),!(vue.unref(U)&&isProdMode()&&X===vue.unref(k))&&(k.value=X,U.value=!0,vue.watch(()=>e,()=>{e&&X.setProps(getDynamicProps(e))},{immediate:!0,deep:!0}))},{setProps:async X=>{(await K()).setProps(X)},updateSchema:async X=>{(await K()).updateSchema(X)},resetSchema:async X=>{(await K()).resetSchema(X)},clearValidate:async X=>{(await K()).clearValidate(X)},resetFields:async()=>{K().then(async X=>{await X.resetFields()})},removeSchemaByFiled:async X=>{vue.unref(k)?.removeSchemaByFiled(X)},getFieldsValue:()=>vue.unref(k)?.getFieldsValue(),setFieldsValue:async X=>{(await K()).setFieldsValue(X)},appendSchemaByField:async(X,W,Q)=>{(await K())?.appendSchemaByField(X,W,Q)},submit:async()=>(await K()).submit()}]}function useComponentRegister(e,k){add(e,k),tryOnUnmounted(()=>{del(e)})}const PdForm=withInstall(Form,{FormItem:_sfc_main$4}),PdFormItem=withNoopInstall(_sfc_main$4),Components=[PdTable,PdForm],_sfc_main={name:"PdContainer",props:{title:null,md:null},data(){return{isPC:!0}},mounted(){},methods:{getIsPc(){return!/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)}}},index_vue_vue_type_style_index_0_lang="",index_vue_vue_type_style_index_1_scope_true_lang="",_hoisted_1={class:"title"},_hoisted_2=vue.createElementVNode("span",{class:"border"},null,-1);function _sfc_render(e,k,U,K,H,G){return vue.openBlock(),vue.createElementBlock("div",{class:vue.normalizeClass(H.isPC?"PandoraContainer":"PandoraContainer-m")},[vue.createElementVNode("div",_hoisted_1,[vue.createElementVNode("span",null,[vue.createTextVNode(vue.toDisplayString(U.title),1),_hoisted_2]),vue.renderSlot(e.$slots,"rightBox")]),vue.createElementVNode("div",{class:vue.normalizeClass(U.md?"context_d":"context")},[vue.renderSlot(e.$slots,"default")],2)],2)}const PandoraContainer=_export_sfc(_sfc_main,[["render",_sfc_render]]),PdContainer=withInstall(PandoraContainer),Plugins=[PdContainer],installer=makeInstaller([...Components,...Plugins]),install=installer.install,version=installer.version;exports.PdContainer=PdContainer,exports.PdForm=PdForm,exports.PdFormItem=PdFormItem,exports.PdTable=PdTable,exports.default=installer,exports.install=install,exports.makeInstaller=makeInstaller,exports.useComponentRegister=useComponentRegister,exports.useForm=useForm,exports.version=version,Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
